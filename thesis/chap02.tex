\chapter{Simulator}

Pybind11 citation \cite{jakob2017pybind11}, DEAP citation \cite{fortin2012deap}

\section{Algorithm Description}

\paragraph{Definition (Unused and Used Streets)} \textit{Unused street} is a street that is either not used by any car at all or it is the final destination of all cars that use it (i.e. traffic light for this street is not needed). \textit{Used street} is a street that is used by at least one car and is not the final destination of at least one car that uses it.

\paragraph{Definition (Unused and Used Intersections)} \textit{Unused intersection} is an intersection where all incoming streets are unused streets. \textit{Used intersection} is an intersection with at least one used incoming street.

\paragraph{Observation (Unused intersections and streets)} Remove unused intersections and unused streets from used intersections before creating the schedules. These only worsen the score and do not help anything. (Obvious)

\paragraph{Definition (Trivial and Non-trivial Intersections)} \textit{Trivial intersection} is an intersection with exactly one used incoming street. \textit{Non-trivial intersection} is an intersection with two or more used incoming streets.

\paragraph{Definition (Blocked Street and Intersection)} \textit{Blocked street} is an unscheduled street or a street with a green light scheduled for 0 seconds. \textit{Blocked intersection} is an intersection with no schedule or with all incoming streets blocked.

\paragraph{Observation (Trivial intersections)} Trivial intersections do not need to be optimized. The schedule for these intersections is always the same: the only used incoming street has a green light the whole time. This allows us to substantially reduce the number of optimized parameters for most of the datasets. (Not so obvious)

But what if it would be better to keep the light red the whole time, effectively blocking all cars on this street? Well, if a car passing through this intersection is problematic, it must reach some non-trivial intersection via a street eventually. Non-trivial intersections are optimized, so such a street can be blocked and the car would stop there. If we block all incoming streets to non-trivial intersections reachable from this trivial intersection, it results in the same score as if we blocked the trivial intersection.

\xxx{TODO: Maybe add graph for better explanation?}

% To consider all cases, suppose that it would be better to block this street by keeping the light red the whole time.
% Even if it would be better to block this street
% This allows us to substantially reduce the number of optimized parameters

\section{Section 2}
